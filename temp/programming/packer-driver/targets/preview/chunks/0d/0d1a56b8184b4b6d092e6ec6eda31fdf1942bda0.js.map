{"version":3,"sources":["file:///Users/super_javan/cocoscreator/PlayCard/assets/Script/View/UIGameView.ts"],"names":["_decorator","Component","Node","Prefab","instantiate","Vec3","UITransform","tween","ECardDir","PLAY_AREA_COUNT","UIPoker","ccclass","property","UIGameView","playGroupList","onLoad","index","playGroup","addComponent","playGruopAnchor","addChild","setPosition","push","createAllCardByDB","pokers","poker","uiPoker","createUIPoker","initArea","node","cardPrefab","getComponent","init","gamePlay","stuck","children","length","removeChild","card","closeSendArea","initPlayGroup","groupIndex","cardIndex","group","wolrdPos","convertToWorldSpaceAR","nodePos","convertToNodeSpaceAR","removeFromParent","position","dir","OPEN","delay","to","scale","call","start"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Prefab, Game, instantiate, Vec3, UITransform, Tween, tween } from 'cc';\nimport { ECardDir } from '../Enum';\nimport GameEngine from '../GameEngine';\nimport GameDB, { PLAY_AREA_COUNT } from '../Model/GameDB';\nimport Poker from '../Model/Poker';\nimport { UIPoker } from '../UI/UIPoker';\nconst { ccclass, property } = _decorator;\n\n@ccclass('UIGameView')\nexport class UIGameView extends Component {\n    @property(Prefab)\n    cardPrefab: Prefab = null\n\n    @property(Node)\n    closeSendArea: Node = null\n    @property(Node)\n    openSendArea: Node = null\n    @property([Node])\n    receiveAreaList: Node[] = []\n    @property(Node)\n    playGruopAnchor: Node = null\n    @property(Node)\n    initArea: Node = null\n\n    playGroupList: Node[] = []\n\n    onLoad() {\n        for (let index = 0; index < PLAY_AREA_COUNT; index++) {\n            let playGroup = new Node()\n            playGroup.addComponent(UITransform)\n            this.playGruopAnchor.addChild(playGroup)\n            playGroup.setPosition(new Vec3(index * 92, 0, 0))\n            this.playGroupList.push(playGroup)\n        }\n    }\n\n    createAllCardByDB(pokers: Poker[]) {\n        //先创建所有牌到init待发牌区\n        let index = 0\n        for (const poker of pokers) {\n            let uiPoker = this.createUIPoker(poker)\n            this.initArea.addChild(uiPoker.node)\n            uiPoker.node.setPosition(0.5 * index, 0.2 * index, 0)\n            index++\n        }\n    }\n\n    createUIPoker(poker: Poker): UIPoker {\n        const cardPrefab = instantiate(this.cardPrefab)\n        const uiPoker = cardPrefab.getComponent(UIPoker)\n        uiPoker.init(poker)\n        return uiPoker\n    }\n\n    //将牌移到close 收牌区\n    gamePlay() {\n        let stuck = []\n        for (let index = this.initArea.children.length - 1; index >= 0; --index) {\n            let children = this.initArea.children[index]\n            this.initArea.removeChild(children)\n            stuck.push(children)\n        }\n\n        for (let index = stuck.length - 1; index >= 0; --index) {\n            const card = stuck[index];\n            this.closeSendArea.addChild(card)\n        }\n    }\n\n    initPlayGroup(groupIndex: number, cardIndex: number, poker: Poker) {\n        let node = poker.UIPoker.node\n        let group = this.playGroupList[groupIndex]\n        let wolrdPos = node.getComponent(UITransform).convertToWorldSpaceAR(new Vec3(0, 0, 0))\n        let nodePos = group.getComponent(UITransform).convertToNodeSpaceAR(wolrdPos)\n        node.removeFromParent()\n        node.position = nodePos\n        group.addChild(node)\n\n        if (poker.dir == ECardDir.OPEN) {\n            tween(node)\n                .delay(0.0)\n                .to(0.8, { position: new Vec3(0, 0, 0) })\n                .to(0.5, { scale: new Vec3(0, 0, 0) })\n                .call(() => {\n\n                })\n                .to(0.5, { scale: new Vec3(1, 0, 0) })\n                .start()\n        } else {\n            tween(node)\n                .delay(0.0)\n                .to(0.8, { position: new Vec3(0, 0, 0) })\n                .start()\n        }\n    }\n}\n\n"]}